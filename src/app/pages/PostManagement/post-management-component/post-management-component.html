<app-toast-component *ngIf="viewToast" [isSuccess]="isToastSuccess" [message]="toastMessage"></app-toast-component>
<div class="grid grid-cols-1 place-items-center min-h-20 md:grid-cols-2 lg:grid-cols-3 ">
        <div class="bg-white shadow-md rounded-lg p-4 flex items-center justify-between w-11/12 max-w-xs mb-5">
  <div>
    <h2 class="text-gray-600 text-sm font-medium">Total Posts</h2>
    <p class="text-2xl font-semibold text-gray-900 mt-1">{{totalProducts}}</p>
  </div>
  <div>
    <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-blue-900" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
  <!-- Post container -->
  <path stroke-linecap="round" stroke-linejoin="round" d="M6 3h12a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V5a2 2 0 012-2z" />
  
  <!-- Image thumbnail box -->
  <rect x="8" y="7" width="8" height="4" rx="1" ry="1" stroke="currentColor" stroke-width="1.5" />
  
  <!-- Content lines -->
  <line x1="8" y1="13" x2="16" y2="13" stroke="currentColor" stroke-width="1.5" />
  <line x1="8" y1="16" x2="14" y2="16" stroke="currentColor" stroke-width="1.5" />
</svg>

  </div>
</div>
        <div class="bg-white shadow-md rounded-lg p-4 flex items-center justify-between w-11/12  max-w-xs mb-5">
  <div>
    <h2 class="text-gray-600 text-sm font-medium">Pending Verification</h2>
    <p class="text-2xl font-semibold text-gray-900 mt-1">{{TotalPages}}</p>
  </div>
  <div>
    <svg class="w-8 h-8 text-orange-500" fill="currentColor" viewBox="0 0 24 24">
      <path d="M12 1a11 11 0 1 0 11 11A11.013 11.013 0 0 0 12 1zm0 20a9 9 0 1 1 9-9 9.01 9.01 0 0 1-9 9zm.5-13h-1v6l5.25 3.15.5-.85-4.75-2.8z"/>
    </svg>
  </div>
</div>
        <div class="bg-white shadow-md rounded-lg p-4 flex items-center justify-between w-11/12  max-w-xs mb-5">
  <div>
    <h2 class="text-gray-600 text-sm font-medium">Rejected Posts</h2>
    <p class="text-2xl font-semibold text-gray-900 mt-1">{{21}}</p>
  </div>
  <div>
    <svg class="w-8 h-8 text-red-600" fill="currentColor" viewBox="0 0 24 24">
      <path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm6.32 13.9L8.1 5.68A8 8 0 0 1 18.32 15.9zM5.68 8.1 15.9 18.32A8 8 0 0 1 5.68 8.1z"/>
    </svg>
  </div>
</div>
    </div>
<div class="bg-white rounded-lg min-w-full p-5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
    @for (post of posts; track $index) {
        <div (click)="handleShowPostDetails(post)" class="mx-auto w-full border hover:-translate-y-0.5 bg-white rounded-xl hover:shadow-md p-6 space-y-4">
            <div class="flex justify-between items-start">
            <div>
                <p class="text-gray-400 text-sm font-mono flex items-center"># <span class="font-bold text-xs text-black line-clamp-1 ms-1">{{post.id}}</span></p>
                <div class="flex items-center">
                    
                    <div class="w-7 h-7 mr-3 mt-1 rounded-full bg-blue-100 flex items-center justify-center font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" 
                            viewBox="0 0 24 24" 
                            fill="none" 
                            stroke="currentColor" 
                            stroke-width="1.5" 
                            class="w-5 h-5 text-blue-600">
                        <circle cx="12" cy="7" r="4" />
                        <path d="M4 20c0-3.5 3.5-6 8-6s8 2.5 8 6" />
                        </svg>
                    </div>
                    <div>
                        <p class="text-md lg:text-sm font-semibold text-gray-800 mt-2">{{post.title}}</p>
                        <p class="text-xs text-gray-500">Seller {{post.seller.username}}</p>
                    </div>
                </div>
                <span [ngClass]="{'bg-red-100 text-red-800':post.status=='Rejected'||post.status=='Expired',
                'bg-green-100 text-green-800':post.status=='Active',
                'bg-yellow-100 text-yellow-800':post.status=='Inactive',
                'bg-orange-100 text-orange-800':post.status=='Pending',
                'bg-pink-100 text-pink-800':post.status=='Sold',
                'bg-purple-100 text-purple-800':post.status=='Removed'
                }"
                class="inline-block  text-sm px-3 py-1 rounded-full mt-2">{{post.status}}</span>
            </div>
            <div class="text-right space-y-2">
                <p class="text-sm text-gray-400 flex items-center justify-end">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 4h10M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z"/>
                </svg>
                {{post.createdAt | date}}
                </p>
                <p class="lg:text-base text-xl font-bold text-blue-900">EGP{{post.price}}</p>
                <div class="space-x-2">
                    <div class="relative inline-block text-left dropdown-wrapper">
                        <button (click)="handleMoreActionDropdown($event,post.id)" class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-900 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-50" type="button"> 
                            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                                <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                            </svg>
                        </button>
                        <div *ngIf="openedDropdownPostId === post.id" (click)="$event.stopPropagation()" class="absolute right-0 mt-2 z-10 bg-white divide-y divide-gray-100 rounded-lg shadow-sm w-44 ">
                            <ul class="py-2 text-sm text-gray-700 " aria-labelledby="dropdownMenuIconHorizontalButton">
                                <li>
                                    <a (click)="changePostStatus(post.id,5)" class="block px-4 py-2 hover:bg-gray-100">Expired</a>
                                </li>
                                <li>
                                    <a (click)="changePostStatus(post.id,2)" class="block px-4 py-2 hover:bg-gray-100">inActive</a>
                                </li>
                                <li>
                                    <a (click)="changePostStatus(post.id,3)" class="block px-4 py-2 hover:bg-gray-100">Pending</a>
                                </li>
                                <li>
                                    <a (click)="changePostStatus(post.id,4)" class="block px-4 py-2 hover:bg-gray-100">Sold</a>
                                </li>
                            </ul>
                            <div class="py-2">
                            <a (click)="changePostStatus(post.id,7)" class="block px-4 py-2 text-sm text-red-700 hover:bg-red-50 ">Remove</a>
                            </div>
                        </div>
                    </div>
                    <button (click)="changePostStatus(post.id,6)" class="inline-block bg-red-100 text-red-800 hover:bg-red-200 text-sm px-3 py-1 rounded-full mt-2">Reject</button>
                    <button (click)="changePostStatus(post.id,1)" class="inline-block bg-blue-100 text-blue-800 hover:bg-blue-200 text-sm px-3 py-1 rounded-full mt-2">Accept</button>
            </div>
            </div>
            </div>
        </div>
    }
<div *ngIf="showPostDetails"  class="fixed inset-0 z-50 flex items-center justify-center w-full p-4 overflow-x-hidden overflow-y-auto bg-black/30">
  <div class="relative mb-6 w-full max-w-2xl max-h-full" (click)="$event.stopPropagation()">
    
    <!-- Modal content -->
    <div class="relative modal-wrapper bg-white rounded-lg shadow-md overflow-hidden">
      
      <!-- Gradient Header with icon and title -->
      <div class="relative bg-gradient-to-br from-[#e7eafc] to-[#f1f5ff] p-6 rounded-t-lg">
        <div class="flex items-center space-x-3">
          <div class="w-16 h-10 bg-[#ccd8ff] rounded-lg flex items-center justify-center">
            <!-- <svg class="w-6 h-6 text-[#4a5fbb]" fill="currentColor" viewBox="0 0 24 24">
              <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zM8 11c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5C15 14.17 10.33 13 8 13zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 2.05 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
            </svg> -->
            <img [src]="selectedPost.assets[0].url" class="bg-cover rounded-md" alt="">
          </div>
          <div>
            <h3 class="text-xl font-semibold text-[#0b313f]">{{selectedPost.title}}</h3>
            <span class="text-sm text-gray-500">Seller {{selectedPost.seller.username}}</span>
          </div>
        </div>
      </div>

      <!-- Modal body -->
        <div class="mb-4 border-b border-gray-200 ms-3">
            <ul class="flex flex-wrap -mb-px text-sm font-medium text-center"  data-tabs-active-classes="text-purple-600 hover:text-purple-600 " role="tablist">
                <li class="me-2" role="presentation">
                    <button (click)="handleModalTabs(1)" class="inline-block text-blue-700 p-4 border-b-2 border-blue-800 rounded-t-lg hover:text-gray-600 hover:border-gray-300" type="button" role="tab" aria-controls="profile" aria-selected="false">Post Details</button>
                </li>
                <li class="me-2" role="presentation">
                    <button (click)="handleModalTabs(2)" class="inline-block text-blue-900 p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300" type="button" role="tab">Seller Details</button>
                </li>
            </ul>
        </div>
         <div *ngIf="activeTab==1" class="p-6 space-y-6"> 
        <div class="grid grid-cols-6 gap-6">
          <div class="col-span-2">
            <div class="relative h-32">
              <img [src]="selectedPost.assets[0].url" alt="Category icon"
                   class="w-full h-full object-contain rounded-lg border border-gray-300" />
            </div>
          </div>
          <div class="col-span-4 ">
            <div class="border "><p class="font-medium text-gray-400 px-4 py-1">Post ID <span class="text-blue-900">{{selectedPost.id}}</span></p></div>
            <div class="border text-blue-900 p-3">
                <p class="font-medium text-gray-400 py-1">Description: </p>
                 <quill-view-html
                [content]="selectedPost.description"
                theme="snow"
            ></quill-view-html>
                </div>
            <div class="border flex"><p class="font-medium text-gray-400 px-4 py-1">Price: <span class="text-blue-900">{{selectedPost.price}} EGP</span></p> 
                <div class="border-s "><p class="font-medium text-gray-400 px-4 py-1">Expiry Date: <span class="text-blue-900">{{selectedPost.expireDate |date}}</span></p></div>
            </div>
            <div class="border flex"><p class="font-medium w-1/2 text-gray-400 px-4 py-1">Condition: <span class="text-blue-900">{{selectedPost.condition}}</span></p>
            <div class="border-s "><p class="font-medium text-gray-400 px-4 py-1">Post Status: <span [ngClass]="{'bg-red-100 text-red-800':selectedPost.status=='Rejected'||selectedPost.status=='Expired',
                'bg-green-100 text-green-800':selectedPost.status=='Active',
                'bg-yellow-100 text-yellow-800':selectedPost.status=='Inactive',
                'bg-orange-100 text-orange-800':selectedPost.status=='Pending',
                'bg-pink-100 text-pink-800':selectedPost.status=='Sold',
                'bg-purple-100 text-purple-800':selectedPost.status=='Removed'
                }" class="rounded-md px-3 py-0.5">{{selectedPost.status}}</span></p></div>
            </div>
            <div class="border flex"><p class="font-medium w-1/2 text-gray-400 px-4 py-1">Category <span class="text-blue-900">{{selectedPost.category}}   </span> <div class="border-s "><p class="font-medium text-gray-400 px-4 py-1">Subcategory <span class="text-blue-900">{{selectedPost.subCategory}}</span></p></div></div>
            
        </div>
        </div>
        </div>
      <div *ngIf="activeTab==2" class="p-6 space-y-6">
        <div class="grid grid-cols-6 gap-6">
            <div class="col-span-3">
                <div class="border p-3 rounded-lg mb-4 flex items-center">
                    <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5 3h14a2 2 0 012 2v3H3V5a2 2 0 012-2zm16 7H3v9a2 2 0 002 2h14a2 2 0 002-2v-9zM7 14h4m-4 2h4" />
                        </svg>
                    </div>
                    <div class="flex-col justify-center items-center ms-4">
                        <p class="text-gray-500 ">Seller ID:</p>
                        <p class="">{{selectedPost.seller.id}}</p>
                    </div>
                </div>
                <div class="border p-3 rounded-lg mb-4 flex items-center">
                    <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-purple-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3L2 9l10 6 10-6-10-6zM2 15h20M6 18h12" />
                        </svg>
                    </div>
                    <div class="flex-col justify-center items-center ms-4">
                        <p class="text-gray-500 ">Seller University:</p>
                        <p class="">{{selectedPost.seller.universityName}}</p>
                    </div>
                </div>
            </div>

            <div class="col-span-3">
                <div class="border p-3 rounded-lg mb-4 flex items-center">
                    <div class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="7" r="4" stroke-linecap="round" stroke-linejoin="round" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 20c0-3.5 3.5-6 8-6s8 2.5 8 6" />
                        </svg>
                    </div>
                    <div class="flex-col justify-center items-center ms-4">
                        <p class="text-gray-500 ">Seller Username:</p>
                        <p class="">{{selectedPost.seller.username}}</p>
                    </div>
                </div>
                <div class="border p-3 rounded-lg mb-4 flex items-center">
                    <div class="w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-orange-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M5 11h14M5 19h14a2 2 0 002-2V7H3v10a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <div class="flex-col justify-center items-center ms-4">
                        <p class="text-gray-500 ">Seller Academic Year:</p>
                        <p class="">{{selectedPost.seller.academicYear}}</p>
                    </div>
                </div>
            </div>
        </div>
      </div>
        <!-- Close button (optional, repositioned if needed) -->
      <button (click)="closeShowPostDetails()"
              type="button"
              class="absolute top-4 right-4 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 inline-flex justify-center items-center">
        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
             viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
        </svg>
        <span class="sr-only">Close modal</span>
      </button>
      
    </div>
  </div>
</div>
    
</div>
<div class="flex justify-center mt-5">
  <nav class="flex items-center space-x-1">
    <!-- Prev Button -->
    <button 
      class="px-3 py-1 rounded border text-sm"
      [disabled]="currentPage === 1"
      (click)="changePage(currentPage - 1)">
      Prev
    </button>

    <!-- Page Numbers -->
    <ng-container *ngFor="let page of visiblePages">
      <button 
        class="px-3 py-1 rounded border text-sm"
        [ngClass]="{
          'bg-blue-600 text-white': page === currentPage,
          'hover:bg-blue-100': page !== currentPage
        }"
        (click)="changePage(page)">
        {{ page }}
      </button>
    </ng-container>

    <!-- Next Button -->
    <button 
      class="px-3 py-1 rounded border text-sm"
      [disabled]="currentPage === TotalPages"
      (click)="changePage(currentPage + 1)">
      Next
    </button>
  </nav>
</div>